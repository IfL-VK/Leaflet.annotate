<!DOCTYPE html>
<html>

	<head>

		<title>Usage Example - Semantic Markup for LeafletJS Marker, Popups and Overlay</title>

		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="author" content="Malte Reißig, IfL Leipzig">

		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
		<link rel="stylesheet" href="css/example.css" />
		<link rel="stylesheet" href="css/viewer-style.css" />
		
		<script src="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet-src.js"></script>
		<script src="//code.jquery.com/jquery-2.2.2.min.js"></script>

		<script src="Leaflet.annotate.Microdata.js"></script>
		<script src="Leaflet.annotate.Viewer.js"></script>

	</head>

	<body>

		<div id="map"></div>

		<div class="author">Meta Mata</div>

		<script type="text/javascript">

			var tileLayerURL = 'https://api.tiles.mapbox.com/v4/maltwisney.91ae9b43/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFsdHdpc25leSIsImEiOiJlODg3M2M5YzFhY2Y2NWMzMmE0Nzk1YWNjMWYwN2U0ZCJ9.b_4gukx7cUR4-spxHbj_Kw'

			function setup_map() {

				var map = L.map('map')
				var tileLayer = L.tileLayer(tileLayerURL, {
					maxZoom: 12, minZoom: 2,
					attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
					'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
					'Imagery © <a href="http://mapbox.com">Mapbox</a>',
					id: 'mapbox.light'
				})

				var newYorkCityMarker = L.marker([39.155800, -87.513970], { itemtype: 'Place',
					title: 'New York City'})
				var poemMarker = L.circleMarker([39.155800, -87.513970], { itemtype: 'CreativeWork',
					title: 'The circle marker locating this meta poem geographically.'
				})				
				var featureGroup = L.featureGroup([newYorkCityMarker, poemMarker])
				
				tileLayer.addTo(map)
				featureGroup.addTo(map)

				$.getJSON('test-geometries/admin0_poly.json', function(response) {
					var statesBoundaries = L.geoJson(response, { itemtype: 'Administrative Area',
						title: 'United States of America'
					}).addTo(map)
					statesBoundaries.annotate()
					/** .setAuthor("Malte Reißig")
					    .setSource("http://www.naturalearth.org")
					    .setDateCreated('2016-01-17')
					    .setDateLastModified('2016-03-08') **/
				})
				
				map.setView(newYorkCityMarker._latlng, 4)

				// --- Defused Work in Progress  ---
				// L.readerPlugin(map)
				// map.setMaxBounds(L.latLngBounds( L.latLng(52.443141053931114, -2.035388946533203), L.latLng(52.55224556690696, -1.748199462890625)))
				/** featureGroup = L.featureGroup([marker1, poemMarker])
					.bindPopup('Hello world!')
					.on('click', function() { alert('Clicked on a group!'); })
					.addTo(map); ***/

				// --- Only jQuery Dependency
				$('#map').css('height', window.innerHeight + 'px')
				$(window).resize(function(e) {
					$('#map').css('height', window.innerHeight + 'px')
				})

			}

			function adjust_map_view() {
				var evt = document.createEvent('UIEvents')
				evt.initUIEvent('resize', true, false, window,0)
				window.dispatchEvent(evt)
			}

			setup_map()
			adjust_map_view()

		</script>

	</body>
</html>
